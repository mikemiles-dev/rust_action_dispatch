{% extends "layout" %}

{% block page %}
  <h1>Runs</h1>

  <div style="float: left">
    <input onchange="applyFilterAndReload('filter', this.value, false, true); return false" class="search" name="search" value="{{ filter }}" autofocus>
  </div>

  <div style="float: right;">
    <div style="float: left; width: 50px; padding: 5px;">
      <b>To:</b><br>
      <b>From:</b>
    </div>
    <div style="float: left; width: 220px">
     <input type="datetime-local"><br>
     <input type="datetime-local">
    </div>
    <div style="float: left">
      <button class="btn" onclick="applyFilterAndReload('filter', '', true, true); return false;">Apply</button>
      <button class="btn" onclick="window.location.href = window.location.pathname; return false;">Clear</button>
    </div>
  </div>
  
  <table>
    <thead>
      <tr>
        <th {% if sort == 'agent_name' %}style="background-color: #999999"{% endif %}>
          <a href="#" onclick="applyFilterAndReload('sort', 'agent_name', true);  return false;">
            Agent Name
          </a>
        </th>
        <th {% if sort == 'job_name' %}style="background-color: #999999"{% endif %}>
          <a href="#" onclick="applyFilterAndReload('sort', 'job_name', true);  return false;">
            Job Name
          </a>
        </th>
        <th {% if sort == 'started_at' %}style="background-color: #999999"{% endif %}>
          <a href="#" onclick="applyFilterAndReload('sort', 'started_at', true);  return false;">
            Started At
          </a>
        </th>
        <th {% if sort == 'completed_at' %}style="background-color: #999999"{% endif %}>
          <a href="#" onclick="applyFilterAndReload('sort', 'completed_at', true);  return false;">
            Completed At
          </a>
        </th>
        <th {% if sort == 'return_code' %}style="background-color: #999999"{% endif %}>
          <a href="#" onclick="applyFilterAndReload('sort', 'return_code', true);  return false;">
            Return Code
          </a>
        </th>
      </tr>
    </thead>
    <tbody>
      {% for item in items %}
        <tr>
          <td>{{ item.agent_name }}</td>
          <td>{{ item.job_name }}</td>
          <td class="utc-date" data-timestamp="{{ item.started_at['$date']['$numberLong'] }}">{{ item.started_at['$date']['$numberLong'] }}</td>
          <td class="utc-date" data-timestamp="{{ item.completed_at['$date']['$numberLong'] }}">{{ item.completed_at['$date']['$numberLong'] }}</td>
          <td>{{ item.return_code }}</td>
        </tr>
      {% endfor %}
    </tbody>
  </table>

  {% include "pagination" %}
 
{% endblock %}